<!DOCTYPE html>
<html xml:th="https://www.thymeleaf.org">
<head th:replace="~{Components :: head('Home')}"></head>
<body class="bg-1 text-1">
<div th:replace="~{Components :: main-navigation}"></div>
<style>
    #project-banner{
        background-image: url("images/Project Banner.svg");
        background-position: center center;
        background-size: cover;
        background-repeat: no-repeat;
    }
    #project-banner > div{
        background-image: linear-gradient(to right, transparent, #ea9431, transparent);
        background-size: 100% 3px;
        background-position: bottom;
        background-repeat: no-repeat;
    }
</style>
<div class="container-fluid mb-5" id="project-banner">
    <div class="container-fluid py-5">
        <h1 class="text-center fw-bold p-5" style="font-size: 4rem">Project History</h1>
    </div>
</div>
<main class="container-fluid">
    <noscript>
        <h2 class="text-center">JavaScript is required to view this page</h2>
    </noscript>
    <div class="container my-4">
        <p align="center">
            <img src="https://skillicons.dev/icons?i=actix" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=azure" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=bash" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=bootstrap" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=cassandra" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=cloudflare" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=cpp" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=css" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=d3" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=docker" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=fastapi" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=git" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=gradle" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=html" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=ai" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=java" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=js" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=jquery" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=mysql" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=postgres" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=postman" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=py" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=react" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=redis" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=rust" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=sass" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=spring" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=tensorflow" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=ts" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=wordpress" style="margin:4px;" />
            <img src="https://skillicons.dev/icons?i=xd" style="margin:4px;" />
        </p>

        <p class="fs-4">
            Welcome to the projects page. Here, you will see a live updating list of my project experiences via Costi Online's project API. My primary focus in coding has predominantly shifted towards the development of full-stack web-based applications. Over the years, I've become well-versed in using Java Spring and Java Hibernate for many of my most recent projects. Additionally, I've also been delving into new frameworks and libraries such as Django and React.
        </p>
        <p class="fs-4">
            Please note that some of the repositories associated with these projects may be unavailable due to their status as school projects or containing personal information.
        </p>
    </div>
    <h3 class="text-center fw-bold mt-4 mb-3">All Projects</h3>
    <ul class="nav nav-pills mb-3 align-items-center justify-content-center" id="pills-tab" role="tablist" style="background-color: transparent;border: none;">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="all-tab" data-bs-toggle="pill" data-bs-target="#all" type="button" role="tab" aria-controls="all" aria-selected="true">All</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="web-tab" data-bs-toggle="pill" data-bs-target="#web" type="button" role="tab" aria-controls="web" aria-selected="false">Web</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="desktop-tab" data-bs-toggle="pill" data-bs-target="#desktop" type="button" role="tab" aria-controls="desktop" aria-selected="false">Desktop</button>
        </li>
    </ul>
    <div class="tab-content container" id="pills-tabContent">
        <div class="tab-pane fade show active" id="all" role="tabpanel" aria-labelledby="all-tab" tabindex="0"><p class="text-center fw-bold">Please wait</p></div>
        <div class="tab-pane fade" id="web" role="tabpanel" aria-labelledby="web-tab" tabindex="0"><p class="text-center fw-bold">Please wait</p></div>
        <div class="tab-pane fade" id="desktop" role="tabpanel" aria-labelledby="desktop-tab" tabindex="0"><p class="text-center fw-bold">Please wait</p></div>
    </div>
</main>
<div th:replace="~{Components :: footer}"></div>
<div th:replace="~{Components :: JS}"></div>
<script>
    let projectList;
    //fetch functions
    fetch("https://costionline.com/api/project/all")
        .then(checkStatus)
        .then(response => response.json())
        .then(data => {
            // Process the retrieved data
            projectList = data;
            renderProjects()
        })
        .catch(error => {
            // error handling
            document.querySelector("#pills-tabContent").innerHTML = "<h3 class=\"text-center\">There was an error receiving data from application server</h3><p class=\"text-center\">Please check the console for further information</p>";
            console.error('Error retrieving data:', error);
        });

    //Render
    function renderProjects(){
        let projectListHTML = ``;
        let webProjectListHTML = ``;
        let desktopProjectListHTML = ``;

        // sort project list
        projectList.sort((a, b) => new Date(b.created) - new Date(a.created));

        projectList.forEach((project) => {

            let logoAndTitle = `<h5 class="card-title fw-bold">${project.name}</h5>`;
            if(project.logo.length > 0){
                logoAndTitle = `
                    <div class="bg-1 rounded-3" style="position: absolute; transform: translate(0%, -75%); z-index: 1;">
                        <img src="${project.logo}" class="p-1" alt="Project Logo" style="aspect-ratio: 1 / 1; object-fit: cover; width: 90px; opacity: 1;">
                    </div>
                    <h5 class="card-title mt-4 fw-bold">${project.name}</h5>
                `;
            }

            let banner = '';
            if(project.imageLinks.length > 0){
                banner = `<img src="${project.imageLinks[0]}" class="card-img-top" alt="banner image" style="aspect-ratio: 2 / 1; object-fit: cover">`;
            }

            let card = `
                    <div class="col-12 col-md-4 col-lg-3 mb-4">
                        <div class="card m-2 h-100">
                            ${banner}
                            <div class="card-body pb-0">
                                ${logoAndTitle}
                                <p class="card-text">${project.description}</p>
                            </div>
                            <div class="flex-shrink-0 p-3">
                                <div class="d-flex flex-row justify-content-between align-items-end">
                                    <div>
                                        <p class="fw-bold mb-1">Created</p>
                                        <p class="mb-0">${formatTimestamp(project.created)}</p>
                                    </div>
                                    <a href="${project.url}" class="btn btn-primary float-end">Repository</a>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

            projectListHTML += card;

            if(project.topics.includes("website")){
                webProjectListHTML += card;
            }

            if(project.topics.includes("desktop")){
                desktopProjectListHTML += card;
            }
        });

        document.querySelector("#all").innerHTML = `
            <div class="row">
                ${projectListHTML}
            </div>
        `;

        document.querySelector("#web").innerHTML = `
            <div class="row">
                ${webProjectListHTML}
            </div>
        `;

        document.querySelector("#desktop").innerHTML = `
            <div class="row">
                ${desktopProjectListHTML}
            </div>
        `;
    }

    function formatTimestamp(dateString) {
        let date = new Date(dateString);
        let day = ("0" + date.getDate()).slice(-2);
        let month = ("0" + (date.getMonth() + 1)).slice(-2);
        let year = date.getFullYear().toString().substr(-2);
        let hours = date.getHours();
        let minutes = ("0" + date.getMinutes()).slice(-2);
        let ampm = hours >= 12 ? 'PM' : 'AM';

        hours = hours % 12;
        hours = hours ? ("0" + hours).slice(-2) : 12;

        return `${month}/${day}/${year} ${hours}:${minutes} ${ampm}`;
    }
</script>
</body>
</html>